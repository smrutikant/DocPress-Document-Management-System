<%- include('../partials/header') %>

<style>
/* Animated SVG Background */
.svg-background {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0.08;
  z-index: 0;
  pointer-events: none;
}

.floating-shape {
  position: absolute;
  animation: float 20s infinite ease-in-out;
}

.shape-1 {
  top: 10%;
  left: 10%;
  animation-delay: 0s;
}

.shape-2 {
  top: 60%;
  left: 70%;
  animation-delay: 5s;
}

.shape-3 {
  top: 30%;
  right: 10%;
  animation-delay: 10s;
}

.shape-4 {
  bottom: 20%;
  left: 30%;
  animation-delay: 15s;
}

@keyframes float {
  0%, 100% {
    transform: translate(0, 0) rotate(0deg);
  }
  25% {
    transform: translate(30px, -30px) rotate(90deg);
  }
  50% {
    transform: translate(-20px, 20px) rotate(180deg);
  }
  75% {
    transform: translate(20px, 30px) rotate(270deg);
  }
}
</style>

<!-- Animated SVG Background -->
<div class="svg-background">
  <svg class="floating-shape shape-1" width="120" height="120" viewBox="0 0 120 120">
    <circle cx="60" cy="60" r="50" fill="var(--accent-color)" opacity="0.6"/>
  </svg>
  <svg class="floating-shape shape-2" width="100" height="100" viewBox="0 0 100 100">
    <rect width="80" height="80" x="10" y="10" fill="#6bb6ff" opacity="0.5" rx="20"/>
  </svg>
  <svg class="floating-shape shape-3" width="90" height="90" viewBox="0 0 90 90">
    <polygon points="45,10 80,70 10,70" fill="var(--accent-color)" opacity="0.4"/>
  </svg>
  <svg class="floating-shape shape-4" width="110" height="110" viewBox="0 0 110 110">
    <ellipse cx="55" cy="55" rx="40" ry="50" fill="#6bb6ff" opacity="0.5"/>
  </svg>
</div>

<div class="user-layout">
  <%- include('../partials/user-sidebar') %>

  <div class="user-content" style="position: relative; z-index: 1;">
    <nav style="margin-bottom: 20px; font-size: 0.9rem;">
      <a href="/subject/<%= topic.subject.slug %>" style="color: var(--accent-color);"><%= topic.subject.title %></a>
      <span style="color: var(--text-secondary);"> â€º </span>
      <span><%= topic.title %></span>
    </nav>

    <div style="margin-bottom: 30px;">
      <% if (topic.coverImage) { %>
        <img src="/<%= topic.coverImage %>" alt="<%= topic.title %>" style="width: 100%; max-height: 300px; object-fit: cover; border-radius: 8px; margin-bottom: 20px;">
      <% } %>
      
      <h1><%= topic.title %></h1>
      <p style="color: var(--text-secondary); font-size: 1.1rem; margin-bottom: 10px;"><%= topic.description || '' %></p>
    </div>

    <% if (topic.concepts && topic.concepts.length > 0) { %>
      <h2>Concepts</h2>
      <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
        <% topic.concepts.forEach((concept, index) => { %>
          <a href="/docs/<%= topic.subject.slug %>/<%= topic.slug %>/<%= concept.slug %>" class="card" style="text-decoration: none; display: block;">
            <div style="display: flex; align-items: start; gap: 15px;">
              <div style="background-color: var(--bg-tertiary); color: var(--accent-color); width: 40px; height: 40px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-weight: 700; flex-shrink: 0;">
                <%= index + 1 %>
              </div>
              <div style="flex: 1;">
                <h3 style="color: var(--text-primary); margin: 0 0 8px 0;"><%= concept.title %></h3>
                <% if (concept.lastRevisedOn) { %>
                  <p style="font-size: 0.85rem; color: var(--text-secondary); margin: 0;">
                    Updated <%= new Date(concept.lastRevisedOn).toLocaleDateString() %>
                  </p>
                <% } %>
              </div>
            </div>
          </a>
        <% }); %>
      </div>
    <% } else { %>
      <p>No concepts available for this topic yet.</p>
    <% } %>
  </div>
</div>

<%- include('../partials/footer') %>
